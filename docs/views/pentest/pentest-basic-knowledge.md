---
author: 星火燎原@vxhly
title: 渗透基础知识
category: [pentest]
tag: [Pentest, PHP, Liunx]
date: 2017-09-03 19:54:18
---

::: tip 前言

整理的渗透所需的一些基础知识。

:::

<!-- more -->

## HTML 表单基础

1. 该表单是提交给哪个文件进行处理的（查看 action 属性值）
2. 向后端程序提交的参数是什么（查看 name 属性）

## SQL 数据库查询语句基础

1. 查询返回所有的结果

```sql
select * from users;
```

2. 条件查询

```sql
select * from users where uame='$uname';
```

3. union 合并多个查询结果

```sql
select * from users union select * from msgs;
```

1. ... ...

## 万能用户名或者万能密码

1. 第一种

```sql
select * from users where uame='' or ''='' and passwd=$passwd;
```

2. 第二种

```sql
select _from users where uame='' union select_ from users and passwd=$passwd;
```

3. 第三种

```sql
select * from users where uame=$uname and passwd='' or ''='';
```

4. ... ...

## 使用 PDO 进行防注入基础

1. 允许长连接

```php
PDO::ATTR_PERSISTENT=>true
```

2. 不允许使用预处理语句

```php
PDO::ATTR_EMULATE_PREPARE=>false
```

3. PDO 连接

```php
$pdh=new PDO(host='127.0.0.1:1433',user='sa',password='root');
```

4. 预处理 SQL 查询语句

```php
$stmt=$dbh->prepare($sql)
```

5. 填充 SQL 语句中的占位符

```php
$stmt->execute(array(...,...,....));
```

6. SQL 占位符（如: select \* from users where uname=? and passwd=?; ）

```sql
select * from users where uname=? and passwd=?;
```

7. ... ...

## Wireshark 抓包

1. 熟练使用 **Wireshark** 这款软件
2. 熟练掌握过滤器的写法（如: `tcp` 、 `udp` 、 `icmp` 、 `mac` ......）
3. 知道各个协议的包结构、包头、包尾
4. ... ...

## 审查代码的能力

1. **HTML** 源文件内容（通过右键网页 –> 查看源文件）
2. **PHP** 代码（了解代码逻辑以及书写规范, 特别是对函数名的记忆）
3. **PYTHON** 代码（快速读懂代码意思, 特别是要从 main 函数入手去查看）
4. **C** 语言代码（从代码中分析出来, 该代码的意思以及各个函数的逻辑）
5. ... ...

## 各个 WEB 漏洞的利用能力

1. **SQL** 注入（通过万能用户名和万能密码来获取一定的 webshell）
2. 命令注入（特别是 PHP 中的 exec 和 system 函数也能获取到一定的 webshell）
3. 文件包含和目录遍历（通过 `../../../../... .../flag.txt` 来获取文件）
4. ... ...

## Liunx 服务的安全配置

1. **SSH**（禁止 root 登录；禁止空密码登录；禁止密钥登录 ... ...）
2. **TELNET**（禁止 root telnet；禁用 telnet ... ...）
3. **VSFTP**（不允许普通用户登录 ftp；禁止匿名用户登录 ftp ... ...）
4. **HTTPD**（禁止回显 banner 信息；严格控制目录权限 ... ...）
5. ... ...

## PHP 安全配置

1. 开启安全模式

```shell
safe_mode = on
```

1. 禁用函数

```shell
disable_functions = system,exec,eval,shell_exec,phpinfo,... ...
```

1. 禁止 SQL 注入

```shell
magic_quotes_gpc = On
```

## PYTHON 渗透脚本基础

1. 了解 scapy 这一模块（特别是在构造数据包的时候该怎么写）
2. 了解 dpkt 封装或者拆解网络协议包
3. 了解 socket 编程
4. 能够从 help 这一帮助函数中获取到其他函数的使用方法
5. 拥有快速阅读脚本的能力和代码逻辑思维
6. ... ...

## Liunx 常用命令

1. **find**

```bash
find  /  -iname  * | xargs  grep  –i  '*key*'
```

2. grep

```bash
grep  '*key*'  ./keystring.txt
```

3. netstat

```bash
netstat –tulnp 11.4 kill -9 [pid] 11.5 chattr +i /etc/passwd
```

4. kill

```bash
kill -9 [pid]
```

5. chattr

```bash
chattr  +i  /etc/passwd /etc/shadow
```

6. useradd

```bash
useradd  -o  -u  0  test
```

## WEB 漏洞训练平台

1.**DVWA** 【[DVWA](https://github.com/ethicalhack3r/DVWA)】 2.**Web For Pentester** 【[Web For Pentester II](https://pentesterlab.com/exercises/web_for_pentester_II)】(请自行安装镜像, 安装时请选择"其他 Liunx 3.x 内核 64 位") 3.**ZVulDrill** 【[ZVulDrill](https://github.com/710leo/ZVulDrill)】(请自行准备 PHP 环境)

4. ... ...

## 网络协议原理

1. **Tcp** 三次握手和四次挥手
2. **Icmp** 发包以及回包
3. **Mac** 防洪原理
4. **ARP** 发广播包, **ARP** 欺骗
5. **Dtp** 生成树攻击原理
6. ... ...

## 关于 PYTHON 的网络渗透编程

1. ARP 扫描

```python
import socket
# or
from scapy.all import *
```

2. ARP 欺骗、ARP 监控

```python
from scapy.all import *
```

3. OS 扫描

```python
import nmap
```

4. Mac 防洪

```python
import socket
# or
from scapy.all import *
```

5. mssql 数据库密码爆破

```python
import pymssql
```

6. 跨越 VlAN 攻击

```python
from scapy.all import *
```

7. Dtp 攻击

```python
from scapy.all import *
```

8. ... ...
