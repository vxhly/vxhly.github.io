---
author: 星火燎原@vxhly
title: Liunx 安全加固命令集合
category: [pentest]
tag: [Liunx, Security, Pentest, Command]
date: 2017-05-20 14:22:42
---

::: tip 前言

收集 Liunx 系统安全加固时, 发现系统漏洞, 修复系统, 加固系统信息等命令集合。

:::

<!-- more -->

## find

```bash
# 使用 uid 查找对应的程序
find / -uid 0 -perm -4000

# 查找哪里拥有写权限
find / -perm -o=w

# 查找名称中包含点和空格的文件
find / -name " " -print
find / -name ".." -print
find / -name ". " -print
find / -name " " -print

# 查找不属于任何人的文件
find / -nouser

# 查找那些文件包含指定文本内容
find / -iname "*" | xrags grep "[String]"

# 查找一小时内新增的文件
find / -cmin -60

# 查找所有不可修改的文件
find . | xargs -I file lsattr -a file 2>/dev/null | grep ‘^….i’

# 查找 SUID root 文件
find / -user root -perm -4000 -print

# 查找 SGID root 文件:
find / -group root -perm -2000 -print

# 查找 SUID 和 SGID 文件:
find / -perm -4000 -o -perm -2000 -print

# 查找不属于任何用户的文件:
find / -nouser -print

# 查找不属于任何用户组的文件:
find / -nogroup -print

# 查找软连接及其指向:
find / -type l -ls
```

## lsof

```bash
# 查找未链接的文件
lsof +L1

# 获取进程打开端口的信息
lsof -i
```

## arp

```bash
# 看看 ARP 表中是否有奇怪的东西
arp -a
```

## getent

```bash
# 查看所有账户
getent passwd

# 查看所有用户组
getent group
```

## chattr

```bash
# 使文件不可修改
chattr -i fileKK
```
