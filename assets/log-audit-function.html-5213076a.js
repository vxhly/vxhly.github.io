import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as n,d as i,a as e,e as c}from"./app-5294595a.js";const d="/assets/redhat-reinforce-16.png",t="/assets/redhat-reinforce-17.png",o={},r=e("div",{class:"hint-container tip"},[e("p",{class:"hint-container-title"},"前言"),e("p",null,"本系列笔记又是 Liunx 学习系列教程的一大步, 本系列学习笔记记录 RedHat 系统的安全加固。本篇笔记是记录系统日志审计的配置, 加强系统的防御能力。")],-1),l=c(`<h2 id="syslog-登录事件记录" tabindex="-1"><a class="header-anchor" href="#syslog-登录事件记录" aria-hidden="true">#</a> syslog 登录事件记录</h2><p>查看参数 <code>authpriv</code> 值, <code>For Exmaple:</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">more</span> /etc/syslog.conf <span class="token operator">|</span> <span class="token function">grep</span> authpriv
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>表名登录事件记录在 <code>/var/log/secure</code> 文件中, 使用以下命令检查非法记录</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">more</span> /var/log/secure <span class="token operator">|</span> <span class="token function">grep</span> refused
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="`+d+`" alt="RedHat 安全加固" tabindex="0" loading="lazy"><figcaption>RedHat 安全加固</figcaption></figure><h2 id="审计功能的进程" tabindex="-1"><a class="header-anchor" href="#审计功能的进程" aria-hidden="true">#</a> 审计功能的进程</h2><p>启动审计进程, <code>For Exmaple:</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">service</span> auditd start
<span class="token function">service</span> psacct start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>启动 <code>psacct</code> 服务</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">service</span> psacct start
<span class="token function">chkconfig</span> psacct on
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查看记录审计的日志" tabindex="-1"><a class="header-anchor" href="#查看记录审计的日志" aria-hidden="true">#</a> 查看记录审计的日志</h2><ul><li><code>auditd</code> 审计进程日志记录在 <code>/var/log/audit/audit.log</code></li><li><code>psacct</code> 日志记录在 <code>/var/account/pacct</code></li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><p><code>pacct</code> 日志是二进制文件, 使用以下命令进行查看</p></div><p><code>For Exmaple:</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>lastcomm <span class="token parameter variable">-f</span> /var/account/pacct
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="登录日志查看" tabindex="-1"><a class="header-anchor" href="#登录日志查看" aria-hidden="true">#</a> 登录日志查看</h2><p><code>lastlog</code> 查看用户最后一次登录时间, <code>For Exmaple:</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>lastlog
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="`+t+'" alt="RedHat 安全加固" tabindex="0" loading="lazy"><figcaption>RedHat 安全加固</figcaption></figure>',20);function p(u,h){return s(),n("div",null,[r,i(" more "),l])}const m=a(o,[["render",p],["__file","log-audit-function.html.vue"]]);export{m as default};
